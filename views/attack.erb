<!DOCTYPE html>
<html>
<head>
	<title>Attack</title>
    <link href="<%= url('/style_ready.css') %>" rel="stylesheet" type="text/css">
    <link rel="stylesheet" media="screen" href="https://fontlibrary.org/face/press-start-2p" type="text/css"/>
</head>
<body>
    <div class="whole-container-ready">
        <div id="hpbar-time-container-ready">
            <div class="name-hp-bar1-ready" style= "background: linear-gradient(to right,rgb(161, 37, 37) 100%,#f70310 0%);">
            <%if $game.player_2.choice_attack == "PUNCH" %>
            <name-hp-bar1-ready style ="background: linear-gradient(to right,rgb(161, 37, 37)  <%=$game.player_1.hit_points%>%,#f70310 0%);">
            <%elsif $game.player_2.choice_attack == "KICK" %>
                <name-hp-bar1-ready style ="background: linear-gradient(to right,rgb(161, 37, 37)  <%=$game.player_1.hit_points%>%,#f70310 0%);">
            <%elsif $game.player_2.choice_attack == "DIRTY LOOK" %>
                <name-hp-bar1-ready style ="background: linear-gradient(to right,rgb(161, 37, 37)  <%=$game.player_1.hit_points%>%,#f70310 0%);">
            <%end%>
                <%= $game.player_1.choice.upcase %> / <%= $game.player_1.hit_points                %>
            </div>
            <div id='timer'>
            </div>
            <div class="name-hp-bar2-ready" style= "background: linear-gradient(to left,rgb(161, 37, 37) 100%,#f70310 0%);">
                <%if $game.player_1.choice_attack == "PUNCH" %>
                <name-hp-bar2-ready style ="background: linear-gradient(to left,rgb(161, 37, 37)  <%=$game.player_2.hit_points%>%,#f70310 0%);">
                <%elsif $game.player_1.choice_attack == "KICK" %>
                <name-hp-bar2-ready style ="background: linear-gradient(to left,rgb(161, 37, 37)  <%=$game.player_2.hit_points%>%,#f70310 0%);">
                <%elsif $game.player_1.choice_attack == "LAUGH" %>
                <name-hp-bar2-ready style ="background: linear-gradient(to left,rgb(161, 37, 37)  <%=$game.player_2.hit_points%>%,#f70310 0%);">
                <%end%>
                <%= $game.player_2.hit_points %> \ <%= $game.player_2.choice.upcase              %>
            </div>
        </div>
            <div class="selected-characters-wrapper-ready">
                <div class="p1-full-box-ready">
                    <%if $game.player_1.choice == "Peter"%>
                        <img style="max-width: 350px; max-height: 350px;" src="images/Peter.png">
                        <%elsif $game.player_1.choice == "Chicken"%>
                        <img style="max-width: 350px; max-height: 350px;" src="images/Chicken.png">
                        <%else%>
                            Error
                    <%end%>
                </div>
                <div class="p2-full-box-ready">
                    <%if $game.player_2.choice == "Peter"%>
                        <img style="max-width: 350px; max-height: 350px;" src="images/Peter.png">
                    <%elsif $game.player_2.choice == "Chicken"%>
                        <img style="max-width: 350px; max-height: 350px;" src="images/Chicken.png">
                    <%else%>
                        Error
                    <%end%>
                </div>
            </div>
            <div class="turn-ready">
  
                <%=$game.current_turn.choice.upcase%>'S TURN !!!
            </div>



            <div class="all_buttons_container">

<form action=/effect method="post"> 
<%if $game.current_turn == $game.player_1 && $game.player_1.choice == "Peter" %>
<input class="button_one_view_attack" type="submit" name="attack_type" value="PUNCH">
<input type="hidden" name="attack_type" value="PUNCH">
<%elsif $game.current_turn == $game.player_1 && $game.player_1.choice == "Chicken" %>
<input class="button_one_view_attack" type="submit" name="attack_type" value="PUNCH">
<input type="hidden" name="attack_type" value="PUNCH">
<%elsif $game.current_turn == $game.player_2 && $game.player_2.choice == "Peter" %>
<input class="button_one_view_attack" type="submit" name="attack_type" value="PUNCH">
<input type="hidden" name="attack_type" value="PUNCH">
<%elsif $game.current_turn == $game.player_2 && $game.player_2.choice == "Chicken" %>
<input class="button_one_view_attack" type="submit" name="attack_type" value="PUNCH">
<input type="hidden" name="attack_type" value="PUNCH">
<%end%>
</form>
<br>
<form action=/effect method="post">
<%if $game.current_turn == $game.player_1 && $game.player_1.choice == "Peter" %>
<input class="button_two_view_attack" type="submit" name="attack_type" value="KICK">
<input type="hidden" name="attack_type" value="KICK">
<%elsif $game.current_turn == $game.player_1 && $game.player_1.choice == "Chicken" %>
<input class="button_two_view_attack" type="submit" name="attack_type" value="KICK">
<input type="hidden" name="attack_type" value="KICK">
<%elsif $game.current_turn == $game.player_2 && $game.player_2.choice == "Peter" %>
<input class="button_two_view_attack" type="submit" name="attack_type" value="KICK">
<input type="hidden" name="attack_type" value="KICK">
<%elsif $game.current_turn == $game.player_2 && $game.player_2.choice == "Chicken" %>
<input class="button_two_view_attack" type="submit" name="attack_type" value="KICK">
<input type="hidden" name="attack_type" value="KICK">
<%end%>
</form>
<br>
<form action=/effect method="post">
<%if $game.current_turn == $game.player_1 && $game.player_1.choice == "Peter" %>
<input class="button_three_view_attack" type="submit" name="attack_type" value="LAUGH">
<input type="hidden" name="attack_type" value="LAUGH">
<%elsif $game.current_turn == $game.player_1 && $game.player_1.choice == "Chicken" %>
<input class="button_three_view_attack" type="submit" name="attack_type" value="DIRTY LOOK">
<input type="hidden" name="attack_type" value="DIRTY LOOK">
<%elsif $game.current_turn == $game.player_2 && $game.player_2.choice == "Peter" %>
<input class="button_three_view_attack" type="submit" name="attack_type" value="LAUGH">
<input type="hidden" name="attack_type" value="LAUGH">
<%elsif $game.current_turn == $game.player_2 && $game.player_2.choice == "Chicken" %>
<input class="button_three_view_attack" type="submit" name="attack_type" value="DIRTY LOOK">
<input type="hidden" name="attack_type" value="DIRTY LOOK">
<%end%>
</form>

</div> 
</div>    

        <script>
            let timeLeft = 10;  /*changed from 99 */
            let elem = document.getElementById('timer');
            let timerId = setInterval(countdown, 1000);
            function countdown() {
                if (timeLeft == -1) {
                    clearTimeout(timerId);
                    doSomething();
                } else {
                    elem.innerHTML = timeLeft;
                    timeLeft--;
                }
            }
            
            function doSomething() {
                window.location.href = "/time_out";
            }
        </script>
    </div>

    

</body>

</html>